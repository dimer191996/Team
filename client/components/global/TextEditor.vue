<template>
  <div>
    <div class="editor">
      <editor-menu-bar class="rounded p-1" :editor="editor" v-slot="{ commands, isActive }">
        <div class="menubar">
          <button class="menubar__button" :class="{ 'is-active': isActive.bold() }" @click="commands.bold">
            <svg xmlns="http://www.w3.org/2000/svg" height="12pt" viewBox="-42 0 426 426.66667" width="12pt">
              <path d="m279.734375 197.566406c24.597656-20.5625 40.597656-51.070312 40.597656-85.566406 0-61.761719-50.238281-112-112-112h-186.664062c-11.777344 0-21.335938 9.535156-21.335938 21.332031s9.558594 21.335938 21.335938 21.335938h21.332031v341.332031h-21.332031c-11.777344 0-21.335938 9.535156-21.335938 21.332031s9.558594 21.335938 21.335938 21.335938h197.332031c67.625 0 122.667969-55.019531 122.667969-122.667969 0-45.546875-25.003907-85.269531-61.933594-106.433594zm-71.402344-154.898437c38.230469 0 69.335938 31.101562 69.335938 69.332031s-31.105469 69.332031-69.335938 69.332031h-122.664062v-138.664062zm10.667969 341.332031h-133.332031v-160h133.332031c44.117188 0 80 35.902344 80 80s-35.882812 80-80 80zm0 0" /></svg>
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.italic() }" @click="commands.italic">
            <svg viewBox="0 0 24 24" class="fill-current" height="12pt" width="12pt">
              <path d="M22.5.248h-7.637a1.25 1.25 0 000 2.5h1.086a.25.25 0 01.211.384L4.78 21.017a.5.5 0 01-.422.231H1.5a1.25 1.25 0 000 2.5h7.637a1.25 1.25 0 000-2.5H8.051a.25.25 0 01-.211-.384L19.22 2.98a.5.5 0 01.422-.232H22.5a1.25 1.25 0 000-2.5z"></path>
            </svg>
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.strike() }" @click="commands.strike">
            <svg xmlns="http://www.w3.org/2000/svg" class="fill-current" height="12pt" width="12pt" viewBox="-42 0 426 426.66667">
              <path d="m320.332031 192h-149.332031c-47.0625 0-85.332031-33.492188-85.332031-74.667969 0-41.171875 38.269531-74.664062 85.332031-74.664062s85.332031 33.492187 85.332031 74.664062c0 11.796875 9.558594 21.335938 21.335938 21.335938 11.773437 0 21.332031-9.539063 21.332031-21.335938 0-64.679687-57.40625-117.332031-128-117.332031s-128 52.652344-128 117.332031c0 28.332031 11.03125 54.359375 29.332031 74.667969h-50.664062c-11.777344 0-21.335938 9.535156-21.335938 21.332031s9.558594 21.335938 21.335938 21.335938h149.332031c47.0625 0 85.332031 33.492187 85.332031 74.664062 0 41.175781-38.269531 74.667969-85.332031 74.667969s-85.332031-33.492188-85.332031-74.667969c0-11.796875-9.558594-21.332031-21.335938-21.332031-11.773437 0-21.332031 9.535156-21.332031 21.332031 0 64.683594 57.40625 117.335938 128 117.335938s128-52.652344 128-117.335938c0-28.328125-11.03125-54.355469-29.332031-74.664062h50.664062c11.777344 0 21.335938-9.539063 21.335938-21.335938s-9.558594-21.332031-21.335938-21.332031zm0 0" /></svg>
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.underline() }" @click="commands.underline">
            <svg xmlns="http://www.w3.org/2000/svg" class="fill-current" height="12pt" width="12pt" viewBox="-21 0 426 426.66667">
              <path d="m363 0h-85.332031c-11.777344 0-21.335938 9.535156-21.335938 21.332031s9.558594 21.335938 21.335938 21.335938h21.332031v170.664062c0 58.816407-47.851562 106.667969-106.667969 106.667969-58.816406 0-106.664062-47.851562-106.664062-106.667969v-170.664062h21.332031c11.777344 0 21.332031-9.539063 21.332031-21.335938s-9.554687-21.332031-21.332031-21.332031h-85.332031c-11.777344 0-21.335938 9.535156-21.335938 21.332031s9.558594 21.335938 21.335938 21.335938h21.332031v170.664062c0 82.328125 66.988281 149.335938 149.332031 149.335938 82.347657 0 149.335938-67.007813 149.335938-149.335938v-170.664062h21.332031c11.777344 0 21.332031-9.539063 21.332031-21.335938s-9.554687-21.332031-21.332031-21.332031zm0 0" />
              <path d="m341.667969 384h-298.667969c-11.777344 0-21.332031 9.535156-21.332031 21.332031s9.554687 21.335938 21.332031 21.335938h298.667969c11.773437 0 21.332031-9.539063 21.332031-21.335938s-9.558594-21.332031-21.332031-21.332031zm0 0" /></svg>
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.paragraph() }" @click="commands.paragraph">
            <svg xmlns="http://www.w3.org/2000/svg" class="fill-current" height="12pt" width="12pt" viewBox="-53 0 426 426.66667">
              <path d="m299 384h-42.667969v-341.332031h26.667969c11.777344 0 21.332031-9.539063 21.332031-21.335938s-9.554687-21.332031-21.332031-21.332031h-176c-58.816406 0-106.667969 47.851562-106.667969 106.667969 0 58.816406 47.851563 106.664062 106.667969 106.664062h42.667969v170.667969h-21.335938c-11.773437 0-21.332031 9.535156-21.332031 21.332031s9.558594 21.335938 21.332031 21.335938h170.667969c11.777344 0 21.332031-9.539063 21.332031-21.335938s-9.554687-21.332031-21.332031-21.332031zm-192-213.332031c-35.285156 0-64-28.714844-64-64 0-35.285157 28.714844-64 64-64h42.667969v128zm85.332031-128h21.335938v341.332031h-21.335938zm0 0" /></svg>
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.heading({ level: 1 }) }" @click="commands.heading({ level: 1 })">
            H1
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.heading({ level: 2 }) }" @click="commands.heading({ level: 2 })">
            H2
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.heading({ level: 3 }) }" @click="commands.heading({ level: 3 })">
            H3
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.bullet_list() }" @click="commands.bullet_list">
            <svg xmlns="http://www.w3.org/2000/svg" class="fill-current" height="12pt" width="12pt" viewBox="0 -43 512 512">
              <path d="m85.332031 42.667969c0 23.5625-19.101562 42.664062-42.664062 42.664062-23.566407 0-42.667969-19.101562-42.667969-42.664062 0-23.566407 19.101562-42.667969 42.667969-42.667969 23.5625 0 42.664062 19.101562 42.664062 42.667969zm0 0" />
              <path d="m85.332031 213.332031c0 23.566407-19.101562 42.667969-42.664062 42.667969-23.566407 0-42.667969-19.101562-42.667969-42.667969 0-23.5625 19.101562-42.664062 42.667969-42.664062 23.5625 0 42.664062 19.101562 42.664062 42.664062zm0 0" />
              <path d="m85.332031 384c0 23.5625-19.101562 42.667969-42.664062 42.667969-23.566407 0-42.667969-19.105469-42.667969-42.667969s19.101562-42.667969 42.667969-42.667969c23.5625 0 42.664062 19.105469 42.664062 42.667969zm0 0" />
              <path d="m170.667969 64h320c11.796875 0 21.332031-9.535156 21.332031-21.332031s-9.535156-21.335938-21.332031-21.335938h-320c-11.796875 0-21.335938 9.539063-21.335938 21.335938s9.539063 21.332031 21.335938 21.332031zm0 0" />
              <path d="m490.667969 192h-320c-11.796875 0-21.335938 9.535156-21.335938 21.332031s9.539063 21.335938 21.335938 21.335938h320c11.796875 0 21.332031-9.539063 21.332031-21.335938s-9.535156-21.332031-21.332031-21.332031zm0 0" />
              <path d="m490.667969 362.667969h-320c-11.796875 0-21.335938 9.535156-21.335938 21.332031s9.539063 21.332031 21.335938 21.332031h320c11.796875 0 21.332031-9.535156 21.332031-21.332031s-9.535156-21.332031-21.332031-21.332031zm0 0" /></svg>
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.ordered_list() }" @click="commands.ordered_list">
            <svg viewBox="0 0 24 24" class="fill-current" height="12pt" width="12pt">
              <path d="M7.75 4.5h15a1 1 0 000-2h-15a1 1 0 000 2zm15 6.5h-15a1 1 0 100 2h15a1 1 0 000-2zm0 8.5h-15a1 1 0 000 2h15a1 1 0 000-2zM2.212 17.248a2 2 0 00-1.933 1.484.75.75 0 101.45.386.5.5 0 11.483.63.75.75 0 100 1.5.5.5 0 11-.482.635.75.75 0 10-1.445.4 2 2 0 103.589-1.648.251.251 0 010-.278 2 2 0 00-1.662-3.111zm2.038-6.5a2 2 0 00-4 0 .75.75 0 001.5 0 .5.5 0 011 0 1.031 1.031 0 01-.227.645L.414 14.029A.75.75 0 001 15.248h2.5a.75.75 0 000-1.5h-.419a.249.249 0 01-.195-.406L3.7 12.33a2.544 2.544 0 00.55-1.582zM4 5.248h-.25A.25.25 0 013.5 5V1.623A1.377 1.377 0 002.125.248H1.5a.75.75 0 000 1.5h.25A.25.25 0 012 2v3a.25.25 0 01-.25.25H1.5a.75.75 0 000 1.5H4a.75.75 0 000-1.5z"></path>
            </svg>
          </button>
          <button class="menubar__button" :class="{ 'is-active': isActive.blockquote() }" @click="commands.blockquote">
            <svg viewBox="0 0 24 24" class="fill-current" height="12pt" width="12pt">
              <path d="M18.559 3.932a4.942 4.942 0 100 9.883 4.609 4.609 0 001.115-.141.25.25 0 01.276.368 6.83 6.83 0 01-5.878 3.523 1.25 1.25 0 000 2.5 9.71 9.71 0 009.428-9.95V8.873a4.947 4.947 0 00-4.941-4.941zm-12.323 0a4.942 4.942 0 000 9.883 4.6 4.6 0 001.115-.141.25.25 0 01.277.368 6.83 6.83 0 01-5.878 3.523 1.25 1.25 0 000 2.5 9.711 9.711 0 009.428-9.95V8.873a4.947 4.947 0 00-4.942-4.941z"></path>
            </svg>
          </button>
          <button class="menubar__button" @click="commands.horizontal_rule">
            <svg viewBox="0 0 24 24" class="fill-current" height="12pt" width="12pt">
              <path d="M5 13a1 1 0 010-2h14a1 1 0 010 2H5z"></path>
            </svg>
          </button>
          <button class="menubar__button" @click="commands.undo">
            <svg viewBox="0 0 24 24" class="fill-current" height="12pt" width="12pt">
              <path d="M17.786 3.77a12.542 12.542 0 00-12.965-.865.249.249 0 01-.292-.045L1.937.269A.507.507 0 001.392.16a.5.5 0 00-.308.462v6.7a.5.5 0 00.5.5h6.7a.5.5 0 00.354-.854L6.783 5.115a.253.253 0 01-.068-.228.249.249 0 01.152-.181 10 10 0 019.466 1.1 9.759 9.759 0 01.094 15.809 1.25 1.25 0 001.473 2.016 12.122 12.122 0 005.013-9.961 12.125 12.125 0 00-5.127-9.9z"></path>
            </svg>
          </button>
          <button class="menubar__button" @click="commands.redo">
            <svg viewBox="0 0 24 24" class="fill-current" height="12pt" width="12pt">
              <path d="M22.608.161a.5.5 0 00-.545.108L19.472 2.86a.25.25 0 01-.292.045 12.537 12.537 0 00-12.966.865A12.259 12.259 0 006.1 23.632a1.25 1.25 0 001.476-2.018 9.759 9.759 0 01.091-15.809 10 10 0 019.466-1.1.25.25 0 01.084.409l-1.85 1.85a.5.5 0 00.354.853h6.7a.5.5 0 00.5-.5V.623a.5.5 0 00-.313-.462z"></path>
            </svg>
          </button>
        </div>
      </editor-menu-bar>
      <editor-content class="editor__content p-2" :editor="editor" />
    </div>
  </div>
  
</template>

<script>
import { Editor, EditorContent, EditorMenuBar } from 'tiptap'
import {
  Blockquote,
  HardBreak,
  Heading,
  HorizontalRule,
  OrderedList,
  BulletList,
  ListItem,
  TodoItem,
  TodoList,
  Bold,
  Italic,
  Link,
  Strike,
  Underline,
  History,
} from 'tiptap-extensions'
export default {
  name:"TextEditor",
  components: {
    EditorContent,
    EditorMenuBar,
  },
  data() {
    return {
      editor: new Editor({
        extensions: [
          new Blockquote(),
          new BulletList(),
          new HardBreak(),
          new Heading({ levels: [1, 2, 3] }),
          new HorizontalRule(),
          new ListItem(),
          new OrderedList(),
          new TodoItem(),
          new TodoList(),
          new Link(),
          new Bold(),
          new Italic(),
          new Strike(),
          new Underline(),
          new History(),
        ],
        onUpdate: ({ getJSON, getHTML }) => {
          this.html = getHTML()
        },
        content: `
          <p>
            Your post content,
          </p>
        `,
      }),
      html: '',
    }
  },
  watch:{
    html(){
      this.$emit('data',this.html)
    }
  },
  beforeDestroy() {
    this.editor.destroy()
  },
}
</script>
<style lang="scss">
</style>